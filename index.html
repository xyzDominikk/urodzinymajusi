<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ù§Ô∏è</title>

<style>
*{box-sizing:border-box}

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:linear-gradient(135deg,#ff758c,#ff7eb3);
height:100vh;
display:flex;
justify-content:center;
align-items:center;
overflow:hidden;
color:white;
}

/* üåå INTRO */
#intro{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:black;
display:flex;
justify-content:center;
align-items:center;
z-index:100;
animation:introOut 1.5s ease forwards;
animation-delay:4s;
}

.intro-text{
text-align:center;
font-size:28px;
letter-spacing:2px;
animation:introText 4s ease forwards;
}

@keyframes introText{
0%{opacity:0;transform:scale(0.9);}
40%{opacity:1;transform:scale(1);}
100%{opacity:1;transform:scale(1.05);}
}

@keyframes introOut{
to{
opacity:0;
filter:blur(20px);
pointer-events:none;
}
}

/* üì± PHONE */
.phone{
width:360px;
background:rgba(0,0,0,0.35);
padding:30px;
border-radius:32px;
text-align:center;
backdrop-filter:blur(20px);
display:none;
}

.showApp{display:block;}

.pulse{
animation:pulse 2s infinite;
}

@keyframes pulse{
0%{background:linear-gradient(135deg,#ff758c,#ff7eb3);}
50%{background:linear-gradient(135deg,#ff5e7e,#ff99cc);}
100%{background:linear-gradient(135deg,#ff758c,#ff7eb3);}
}

button{
padding:14px 20px;
border:none;
border-radius:16px;
font-size:16px;
margin-top:15px;
}

button:disabled{opacity:.4}

.countdown-end{
animation:countdownExit 3s forwards;
}

@keyframes countdownExit{
0%{transform:scale(1);opacity:1;}
50%{transform:scale(1.4);}
100%{transform:scale(0.6);opacity:0;filter:blur(6px);}
}

/* üíå LETTER */
.letter{
position:fixed;
bottom:-100%;
left:50%;
transform:translateX(-50%);
width:320px;
background:white;
color:black;
padding:25px;
border-radius:20px;
transition:1s;
z-index:10;
}

.letter.show{
bottom:50%;
transform:translate(-50%,50%);
}

.gallery{display:none;margin-top:15px;}
.gallery img{width:90px;border-radius:12px;margin:4px;}

canvas{
position:fixed;
top:0;
left:0;
pointer-events:none;
}
</style>
</head>

<body>

<!-- üåå INTRO -->
<div id="intro">
<div class="intro-text">
Dla Ciebie ‚ù§Ô∏è<br>
<small style="opacity:.6">22.02</small>
</div>
</div>

<canvas id="confetti"></canvas>

<!-- üì± APP -->
<div class="phone" id="phone">
<h2 id="countdown">≈Åadowanie...</h2>

<button id="openBtn" onclick="openLetter()" disabled>
üîí List zablokowany
</button>

<div class="gallery" id="gallery">
<h3>üñºÔ∏è Wspomnienia</h3>
<img src="https://picsum.photos/100?1">
<img src="https://picsum.photos/100?2">
<img src="https://picsum.photos/100?3">
</div>
</div>

<!-- üíå LETTER -->
<div class="letter" id="letter">
<h2>üíå</h2>
<p id="typedText"></p>
<button onclick="finishReading()">Zamknij</button>
</div>

<audio id="music" src="muzyka.mp3"></audio>

<script>
/* ‚è∞ DATA */
const birthday=new Date(2026,1,22,0,0,0);
let offset=0;
let unlocked=false;
let confettiDone=false;

const fullText=`Tu wklej sw√≥j list ‚ù§Ô∏è`;
let index=0;

/* üåê TIME */
async function syncTime(){
try{
const r=await fetch("https://worldtimeapi.org/api/ip");
const d=await r.json();
offset=new Date(d.datetime)-new Date();
}catch{}
}
const now=()=>new Date(new Date().getTime()+offset);

/* üåå INTRO ‚Üí APP */
setTimeout(()=>{
document.getElementById("phone").classList.add("showApp");
},4500);

/* ‚è≥ COUNTDOWN */
function updateCountdown(){
const diff=birthday-now();
const el=document.getElementById("countdown");

if(diff<=0 && !unlocked){
unlocked=true;
el.innerText="üéâ Wszystkiego najlepszego!";
el.classList.add("countdown-end");

setTimeout(()=>el.style.display="none",3000);

document.body.classList.add("pulse");

const btn=document.getElementById("openBtn");
btn.disabled=false;
btn.innerText="üíå Otw√≥rz list";

navigator.vibrate?.([120,40,120]);

startConfettiOnce();
fadeInMusic();
return;
}

if(diff>0){
const d=Math.floor(diff/(1000*60*60*24));
const h=Math.floor((diff/(1000*60*60))%24);
const m=Math.floor((diff/(1000*60))%60);
const s=Math.floor((diff/1000)%60);
el.innerText=`${d}d ${h}h ${m}m ${s}s`;
}
}

setInterval(updateCountdown,1000);

/* üíå LETTER */
function openLetter(){
document.getElementById("letter").classList.add("show");
typeWriter();
}

function typeWriter(){
if(index<fullText.length){
typedText.innerHTML+=fullText.charAt(index++);
setTimeout(typeWriter,35);
}
}

function finishReading(){
letter.classList.remove("show");
gallery.style.display="block";
}

/* üéµ MUSIC */
function fadeInMusic(){
const m=document.getElementById("music");
m.volume=0;
m.play().catch(()=>{});
let v=0;
const i=setInterval(()=>{
if(v<1){v+=0.05;m.volume=v;}
else clearInterval(i);
},200);
}

/* üéâ CONFETTI */
const canvas=document.getElementById("confetti");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;
let pieces=[];

function startConfettiOnce(){
if(confettiDone) return;
confettiDone=true;
for(let i=0;i<150;i++){
pieces.push({x:Math.random()*canvas.width,y:-20,s:Math.random()*8+4,v:Math.random()*3+2});
}
animate();
}

function animate(){
ctx.clearRect(0,0,canvas.width,canvas.height);
pieces.forEach(p=>{
p.y+=p.v;
ctx.fillRect(p.x,p.y,p.s,p.s);
});
requestAnimationFrame(animate);
}

syncTime().then(updateCountdown);
</script>

</body>
</html>
